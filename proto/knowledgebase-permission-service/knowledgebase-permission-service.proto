syntax = "proto3";

package knowledgebase_permission_service;

import "google/protobuf/empty.proto";

option go_package = "gitlab.ai-yuanjing.cn/ai-platform-private/backend-used-bff/common-api/api/proto/knowledgebase-permission-service";

service KnowledgeBasePermissionService {
  // 查询知识库用户权限
  rpc SelectKnowledgeUserPermission(KnowledgeUserPermissionReq) returns (KnowledgeUserPermissionResp) {}
  // 校验知识库用户权限,此组织下的userId 需要拥有的权限大于等于 permissionType
  rpc CheckKnowledgeUserPermission(CheckKnowledgeUserPermissionReq) returns (google.protobuf.Empty) {}
  // 增加知识库用户
  rpc AddKnowledgeUser(AddKnowledgeUserReq) returns (google.protobuf.Empty) {}
  // 修改知识库用户
  rpc EditKnowledgeUser(EditKnowledgeUserReq) returns (google.protobuf.Empty) {}
  // 删除知识库用户
  rpc DeleteKnowledgeUser(DeleteKnowledgeUserReq) returns (google.protobuf.Empty) {}
  // 转让知识库管理员权限
  rpc TransferKnowledgeAdminUser(TransferKnowledgeAdminUserReq) returns (google.protobuf.Empty) {}
}

message KnowledgeUserPermissionReq {
  string userId = 1;
  string orgId = 2;
  string knowledgeId = 3; //知识库id
}

message CheckKnowledgeUserPermissionReq {
  string userId = 1;
  string orgId = 2;
  string knowledgeId = 3; //知识库id
  int32 permissionType = 4; //权限类型:0: 查看权限; 10: 编辑权限; 20: 授权权限,数值不连续的原因防止后续有中间权限，目前逻辑 授权权限>编辑权限>查看权限
}

message AddKnowledgeUserReq {
  string userId = 1;
  string orgId = 2;
  string knowledgeId = 3; //知识库id
  int32 permissionType = 4; //权限类型:0: 查看权限; 10: 编辑权限; 20: 授权权限,数值不连续的原因防止后续有中间权限，目前逻辑 授权权限>编辑权限>查看权限
  repeated KnowledgeUserInfo knowledgeUserList = 5; //知识库用户信息
}

message KnowledgeUserInfo {
  string userId = 1;
  string orgId = 2;
  int32 permissionType = 3; // 权限类型: -1 删除此用户权限；0: 查看权限; 10: 编辑权限; 20: 授权权限,数值不连续的原因防止后续有中间权限，目前逻辑 授权权限>编辑权限>查看权限
  string permissionId = 4; //权限id 编辑删除才有用
}

message EditKnowledgeUserReq {
  string userId = 1;
  string orgId = 2;
  string knowledgeId = 3; //知识库id
  KnowledgeUserInfo knowledgeUser = 4; //知识库用户信息
}

message DeleteKnowledgeUserReq {
  string userId = 1;
  string orgId = 2;
  string knowledgeId = 3; //知识库id
  string permissionId = 4; //权限id 编辑删除才有用
}

message TransferKnowledgeAdminUserReq{
  string userId = 1;
  string orgId = 2;
  string knowledgeId = 3; //知识库id
  string permissionId = 4; //权限id
  KnowledgeUserInfo knowledgeUser = 5; //知识库用户信息
}

message KnowledgeUserPermissionResp {
  repeated KnowledgeUserInfo knowledgeUserList = 1;
}